<pre style="font-family:monospace;color: rgb(68, 68, 68); background-color: rgb(243, 243, 243); font-weight: 400; "><ol style="padding-left: 3em;"><li><span style="color: rgb(68, 68, 68); font-weight: 700;">import</span> tkinter <span style="color: rgb(68, 68, 68); font-weight: 700;">as</span> tk</li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">from</span> tkinter <span style="color: rgb(68, 68, 68); font-weight: 700;">import</span> messagebox</li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">from</span> datetime <span style="color: rgb(68, 68, 68); font-weight: 700;">import</span> datetime, timedelta</li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">from</span> tkinter <span style="color: rgb(68, 68, 68); font-weight: 700;">import</span> ttk</li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">import</span> random</li><li></li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">class</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">PCS</span>:</li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">__init__</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self, root</span>):</li><li>        self.root = root</li><li>        root.iconbitmap(default=<span style="color: rgb(136, 0, 0); font-weight: 400;">"logo.ico"</span>)</li><li>        self.root.title(<span style="color: rgb(136, 0, 0); font-weight: 400;">"PCS-NOVOMET"</span>)</li><li>        self.root.geometry(<span style="color: rgb(136, 0, 0); font-weight: 400;">"1280x720"</span>)  <span style="color: rgb(105, 112, 112); font-weight: 400;"># Начальный размер окна</span></li><li>        self.root.resizable(<span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>, <span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>)  <span style="color: rgb(105, 112, 112); font-weight: 400;"># Разрешить изменение размера окна</span></li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Создание меню</span></li><li>        self.menu = tk.Menu(self.root)</li><li>        self.root.config(menu=self.menu)</li><li>        self.menu.add_command(label=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Закупки"</span>, command=self.open_purchases)</li><li>        self.menu.add_command(label=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Логистика"</span>, command=self.open_logistics)</li><li>        self.menu.add_command(label=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Производство"</span>, command=self.open_production)</li><li>        self.menu.add_command(label=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Качество"</span>, command=self.open_quality)</li><li>        self.menu.add_command(label=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Отчетность"</span>, command=self.open_reporting)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Основной фрейм для контента</span></li><li>        self.main_frame = tk.Frame(self.root)</li><li>        self.main_frame.pack(side=tk.LEFT, fill=tk.BOTH, expand=<span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Фрейм для технических показателей</span></li><li>        self.tech_frame = tk.Frame(self.main_frame, bd=<span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>, relief=tk.RAISED)</li><li>        self.tech_frame.pack(side=tk.TOP, fill=tk.BOTH, expand=<span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Заголовок для технических показателей</span></li><li>        tech_title = tk.Label(self.tech_frame, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Технические показатели"</span>, font=(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Arial"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">16</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"bold"</span>))</li><li>        tech_title.pack(pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Создание таблиц для технических показателей</span></li><li>        self.create_technical_tables()</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Фрейм для статус-баров</span></li><li>        self.status_frame = tk.Frame(self.main_frame)</li><li>        self.status_frame.pack(side=tk.TOP, fill=tk.X)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Создание статус-баров для каждого цеха</span></li><li>        self.status_labels = []</li><li>        self.progress_vars = []</li><li></li><li>        <span style="color: rgb(68, 68, 68); font-weight: 700;">for</span> i <span style="color: rgb(68, 68, 68); font-weight: 700;">in</span> <span style="color: rgb(57, 115, 0); font-weight: 400;">range</span>(<span style="color: rgb(136, 0, 0); font-weight: 400;">8</span>):</li><li>            status_bar = tk.Frame(self.status_frame, bd=<span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>, relief=tk.SUNKEN)</li><li>            status_bar.pack(side=tk.TOP, fill=tk.X, pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">2</span>)</li><li></li><li>            status_label = tk.Label(status_bar, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">f"Цех <span style="color: rgb(136, 0, 0); font-weight: 400;">{i + <span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>}</span>: Загруженность: 0%"</span>, bd=<span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>, anchor=<span style="color: rgb(136, 0, 0); font-weight: 400;">'w'</span>)</li><li>            status_label.pack(side=tk.LEFT, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>)</li><li></li><li>            progress_var = tk.DoubleVar()</li><li>            progress_bar = ttk.Progressbar(status_bar, variable=progress_var, maximum=<span style="color: rgb(136, 0, 0); font-weight: 400;">100</span>)</li><li>            progress_bar.pack(side=tk.RIGHT, fill=tk.X, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>)</li><li></li><li>            self.status_labels.append(status_label)</li><li>            self.progress_vars.append(progress_var)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Фрейм для новостей</span></li><li>        self.news_frame = tk.Frame(self.root, bg=<span style="color: rgb(136, 0, 0); font-weight: 400;">"lightgrey"</span>, bd=<span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>)</li><li>        self.news_frame.pack(side=tk.RIGHT, fill=tk.Y, padx=(<span style="color: rgb(136, 0, 0); font-weight: 400;">0</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>))</li><li>        self.news_frame.config(width=<span style="color: rgb(57, 115, 0); font-weight: 400;">int</span>(<span style="color: rgb(136, 0, 0); font-weight: 400;">0.15</span> * <span style="color: rgb(136, 0, 0); font-weight: 400;">1280</span>))</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Заголовок для новостей</span></li><li>        self.news_title = tk.Label(self.news_frame, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Последние новости"</span>, bg=<span style="color: rgb(136, 0, 0); font-weight: 400;">"lightgrey"</span>, font=(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Arial"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">16</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"bold"</span>))</li><li>        self.news_title.pack(pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Пример новостей</span></li><li>        self.news_blocks = [</li><li>            <span style="color: rgb(136, 0, 0); font-weight: 400;">f"Успешно завершено производство новой партии метел. Все изделия прошли контроль качества."</span>,</li><li>            <span style="color: rgb(136, 0, 0); font-weight: 400;">f"Запущен новый проект по улучшению экологичности упаковки продукции."</span>,</li><li>            <span style="color: rgb(136, 0, 0); font-weight: 400;">f"Введены новые стандарты качества для древесины, используемой в производстве метел."</span>,</li><li>            <span style="color: rgb(136, 0, 0); font-weight: 400;">f"Проведено обучение сотрудников по новым технологиям производства."</span>,</li><li>            <span style="color: rgb(136, 0, 0); font-weight: 400;">f"Подписан контракт на поставку сырья с новым поставщиком."</span>,</li><li>        ]</li><li></li><li>        <span style="color: rgb(68, 68, 68); font-weight: 700;">for</span> i, news <span style="color: rgb(68, 68, 68); font-weight: 700;">in</span> <span style="color: rgb(57, 115, 0); font-weight: 400;">enumerate</span>(self.news_blocks):</li><li>            news_block = tk.Frame(self.news_frame, bd=<span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>, relief=tk.SUNKEN)</li><li>            news_block.pack(pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>, fill=tk.X)</li><li></li><li>            news_label = tk.Label(news_block, text=news, anchor=<span style="color: rgb(136, 0, 0); font-weight: 400;">'w'</span>, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>, pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>, wraplength=<span style="color: rgb(57, 115, 0); font-weight: 400;">int</span>(<span style="color: rgb(136, 0, 0); font-weight: 400;">0.15</span> * <span style="color: rgb(136, 0, 0); font-weight: 400;">1280</span>))</li><li>            news_label.pack(side=tk.LEFT, fill=tk.BOTH)</li><li></li><li>            news_date = (datetime.now() - timedelta(days=i + <span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>)).strftime(<span style="color: rgb(136, 0, 0); font-weight: 400;">'%Y-%m-%d'</span>)</li><li>            date_label = tk.Label(news_block, text=news_date, fg=<span style="color: rgb(136, 0, 0); font-weight: 400;">"grey"</span>, anchor=<span style="color: rgb(136, 0, 0); font-weight: 400;">'e'</span>, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>, pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">5</span>)</li><li>            date_label.pack(side=tk.RIGHT)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Запуск обновления статус-баров</span></li><li>        self.update_status_bars()</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">create_technical_tables</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Фрейм для производственных показателей</span></li><li>        prod_frame = tk.LabelFrame(self.tech_frame, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Производственные показатели"</span>, font=(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Arial"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">12</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"bold"</span>))</li><li>        prod_frame.pack(pady=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>, padx=<span style="color: rgb(136, 0, 0); font-weight: 400;">10</span>, fill=tk.BOTH, expand=<span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Создание таблицы для производственных показателей</span></li><li>        self.prod_tree = ttk.Treeview(prod_frame, columns=(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Показатель"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Значение"</span>), show=<span style="color: rgb(136, 0, 0); font-weight: 400;">'headings'</span>)</li><li>        self.prod_tree.heading(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Показатель"</span>, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Показатель"</span>)</li><li>        self.prod_tree.heading(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Значение"</span>, text=<span style="color: rgb(136, 0, 0); font-weight: 400;">"Значение"</span>)</li><li>        self.prod_tree.pack(fill=tk.BOTH, expand=<span style="color: rgb(102, 153, 85); font-weight: 400;">True</span>)</li><li></li><li>        <span style="color: rgb(105, 112, 112); font-weight: 400;"># Добавление производственных показателей</span></li><li>        prod_data = [</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Производительность"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"1200 единиц/день"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Уровень брака"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"2%"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Среднее время простоя"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"1 час/неделя"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Количество заказов в день"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"200"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Средняя скорость производства"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"500 единиц/час"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Процент выполненных заказов"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"95%"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Общее время работы"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"16 часов/день"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Количество сотрудников"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"50"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Нагрузка на оборудование"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"75%"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Процент выполнения плана"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"90%"</span>),</li><li>            (<span style="color: rgb(136, 0, 0); font-weight: 400;">"Среднее время выполнения заказа"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"3 часа"</span>),</li><li>        ]</li><li></li><li>        <span style="color: rgb(68, 68, 68); font-weight: 700;">for</span> item <span style="color: rgb(68, 68, 68); font-weight: 700;">in</span> prod_data:</li><li>            self.prod_tree.insert(<span style="color: rgb(136, 0, 0); font-weight: 400;">""</span>, tk.END, values=item)</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">update_status_bars</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        <span style="color: rgb(136, 0, 0); font-weight: 400;">"""Обновляет статус-бары каждые 2 секунды."""</span></li><li>        <span style="color: rgb(68, 68, 68); font-weight: 700;">for</span> i <span style="color: rgb(68, 68, 68); font-weight: 700;">in</span> <span style="color: rgb(57, 115, 0); font-weight: 400;">range</span>(<span style="color: rgb(136, 0, 0); font-weight: 400;">8</span>):</li><li>            <span style="color: rgb(105, 112, 112); font-weight: 400;"># Обновление текста статус-бара</span></li><li>            current_load = random.randint(<span style="color: rgb(136, 0, 0); font-weight: 400;">0</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">100</span>)</li><li>            self.status_labels[i].config(text=<span style="color: rgb(136, 0, 0); font-weight: 400;">f"Цех <span style="color: rgb(136, 0, 0); font-weight: 400;">{i + <span style="color: rgb(136, 0, 0); font-weight: 400;">1</span>}</span>: Загруженность: <span style="color: rgb(136, 0, 0); font-weight: 400;">{current_load}</span>%"</span>)</li><li>            self.progress_vars[i].<span style="color: rgb(57, 115, 0); font-weight: 400;">set</span>(current_load)</li><li></li><li>        self.root.after(<span style="color: rgb(136, 0, 0); font-weight: 400;">2000</span>, self.update_status_bars)  <span style="color: rgb(105, 112, 112); font-weight: 400;"># Запланировать следующий вызов через 2 секунды</span></li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">open_purchases</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        messagebox.showinfo(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Закупки"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Открыта вкладка Закупки"</span>)</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">open_logistics</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        messagebox.showinfo(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Логистика"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Открыта вкладка Логистика"</span>)</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">open_production</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        messagebox.showinfo(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Производство"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Открыта вкладка Производство"</span>)</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">open_quality</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        messagebox.showinfo(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Качество"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Открыта вкладка Качество"</span>)</li><li></li><li>    <span style="color: rgb(68, 68, 68); font-weight: 700;">def</span> <span style="color: rgb(136, 0, 0); font-weight: 700;">open_reporting</span>(<span style="color: rgb(68, 68, 68); font-weight: 400;">self</span>):</li><li>        messagebox.showinfo(<span style="color: rgb(136, 0, 0); font-weight: 400;">"Отчетность"</span>, <span style="color: rgb(136, 0, 0); font-weight: 400;">"Открыта вкладка Отчетность"</span>)</li><li></li><li><span style="color: rgb(68, 68, 68); font-weight: 700;">if</span> __name__ == <span style="color: rgb(136, 0, 0); font-weight: 400;">"__main__"</span>:</li><li>    root = tk.Tk()</li><li>    app = PCS(root)</li><li>    root.mainloop()</li><li></li></ol></pre>